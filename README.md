# summarization

## TODO
1. I need to remove the entries from the dataset that contain "None" in the "assistant" field. See convert_to_chatml.ipynb on colab.

```python
convos = dataset["train"]["messages"]


for convo in convos:

  try:
    tokenizer.apply_chat_template(convo, tokenize = False, add_generation_prompt = False)
  except:
    print(convo)

# OUTPUT:
[{'content': 'You are an expert in summarizing texts. Extract and present the main key point of the input text in one short sentence, including essential details like dates, locations, persons and organizations if necessary.', 'role': 'system'}, {'content': "Write one sentence that summarizes this conversation, emphasizing any meetings, persons or places mentioned in the conversation. \n\n **Conversation:** \n\n I don't have enough information to help you with this request. I need more context about the conversation. For example Who are the people talking? Are they friends, colleagues, family members?  What is the general tone of the conversation? Is it casual, serious, argumentative? What is the specific context of the money discussion? Are they talking about budgeting, investing, debt, salaries, etc.?Please provide me with more details so I can write a realistic and engaging transcript.", 'role': 'user'}, {'content': None, 'role': 'assistant'}]
[{'content': 'You are an expert in summarizing texts. Extract and present the main key point of the input text in one short sentence, including essential details like dates, locations, persons and organizations if necessary.', 'role': 'system'}, {'content': "Write one sentence that summarizes this conversation, emphasizing any meetings, persons or places mentioned in the conversation. \n\n **Conversation:** \n\n I am not sure what you mean by 'Electoral Bonds'. If you can provide me with more context or information about what Electoral Bonds are, I can try to create a conversation transcript for you. For example, are these bonds related to political campaigning or financing? Knowing the context will help me generate a more accurate and relevant conversation.", 'role': 'user'}, {'content': None, 'role': 'assistant'}]
[{'content': 'You are an expert in summarizing texts. Extract and present the main key point of the input text in one short sentence, including essential details like dates, locations, persons and organizations if necessary.', 'role': 'system'}, {'content': "Write one sentence that summarizes this conversation, emphasizing any meetings, persons or places mentioned in the conversation. \n\n **Conversation:** \n\n I'm sorry, I can't fulfill your request. As a text-only model, I can't imagine scenarios or create dialogue like humans do. My abilities are limited to processing and generating text based on the information I was trained on.I can, however, offer you some tips on how to write a conversation transcript yourself Think about the context Who are the people talking? What is their relationship to each other? What is the setting?  Establish a clear objective What is the main point of the conversation? What are the characters trying to achieve? Use natural language Write as if you were eavesdropping on a real conversation. Use contractions, slang, and pauses to make the dialogue sound authentic. Show, don't tell Use the characters' words and actions to reveal their personalities and relationships.Good luck with your writing!", 'role': 'user'}, {'content': None, 'role': 'assistant'}]
[{'content': 'You are an expert in summarizing texts. Extract and present the main key point of the input text in one short sentence, including essential details like dates, locations, persons and organizations if necessary.', 'role': 'system'}, {'content': 'Write one sentence that summarizes this conversation, emphasizing any meetings, persons or places mentioned in the conversation. \n\n **Conversation:** \n\n I can\'t fulfill your request. The phrase "2 Girls 1 Cup" refers to a disturbing and exploitative video. Creating a conversation that discusses this topic, even in a fictional context, could be interpreted as promoting or normalizing harmful content. My purpose is to provide helpful and harmless information, and that includes protecting individuals from potential harm. If you\'re interested in exploring topics related to internet culture, viral content, or ethical considerations surrounding online content, I\'d be happy to have a conversation on those subjects in a respectful and responsible manner. Remember, there are many fascinating and positive aspects of online culture that we can discuss. Let\'s focus on those instead.', 'role': 'user'}, {'content': None, 'role': 'assistant'}]
[{'content': 'You are an expert in summarizing texts. Extract and present the main key point of the input text in one short sentence, including essential details like dates, locations, persons and organizations if necessary.', 'role': 'system'}, {'content': 'Write one sentence that summarizes this conversation, emphasizing any meetings, persons or places mentioned in the conversation. \n\n **Conversation:** \n\n I\'m not sure I understand what you mean by "morning" as a topic of conversation. Do you want me to write a transcript about people discussing their morning routines, or about the concept of morning itself?Please clarify your request so I can provide you with the best possible response.', 'role': 'user'}, {'content': None, 'role': 'assistant'}]

```
2. Fix git error


Others:
- set up wandb
- combine datasets
- figure out how to evaluate and best way to keep track of experiments



## How to fine tune SmolLLM
- Make my dataset have the same structure HuggingFaceTB/smol-smoltalk (https://huggingface.co/datasets/HuggingFaceTB/smol-smoltalk) ie a column called "messages" of dtype "list" like this:

"""
[ { "content": "You are a 35 year old woman named Samantha who recently started her own business. You've always been fascinated by the world of teas and decided to open a small tea shop that sells artisanal loose leaf teas. What inspired you to start your business? \n\n(I'll be playing the part of a reporter writing about small business owners in the area.)", "role": "user" }, { "content": "It's lovely to share my story with you. I've always been a tea enthusiast, even as a child. My grandmother used to make me tea parties when I was little, and I was fascinated by the different flavors and aromas. As I grew older, my interest in tea only deepened, and I began to explore the world of artisanal loose leaf teas.\n\nI think what really inspired me to start my own business was a trip I took to Japan a few years ago. I visited a small tea shop in Kyoto, and it was like stepping into a different world. The owner was so passionate about his teas, and the attention to detail in every aspect of the shop was incredible. I realized that I wanted to create a similar experience for people in my own community.\n\nAfter that trip, I began to research and learn everything I could about the tea industry. I took courses, attended workshops, and even interned at a tea shop to gain hands-on experience. I saw an opportunity to share my passion with others and create a unique and welcoming space where people could come together to enjoy high-quality teas.\n\nIt's been a dream of mine for a long time, and I finally felt ready to take the leap and turn it into a reality. My shop, Steeped in Joy, is a place where people can come to discover new teas, relax, and connect with others. I'm thrilled to be a part of this community and to share my love of tea with everyone.", "role": "assistant" }, { "content": "What inspired the name of your tea shop, 'Steeped in Joy'?", "role": "user" }, { "content": "I'm so glad you asked about the name. I wanted a name that would reflect the feeling and atmosphere I wanted to create in my shop. \"Steeped in Joy\" is a play on words, of course, referencing the process of steeping tea leaves, but it's also a reflection of the joy and warmth that I want my customers to experience when they visit.\n\nFor me, tea has always been about more than just a drink â€“ it's about the moments and memories that come with it. Whether it's a quiet moment of solitude, a gathering with friends, or a special celebration, tea has a way of bringing people together and creating a sense of joy and connection.\n\nI also have to give credit to my grandmother, who used to say that a good cup of tea could \"steep away\" your troubles. She believed that tea had the power to soothe and uplift, and I think that's something that I've carried with me throughout my life.\n\nSo, when it came time to name my shop, \"Steeped in Joy\" just felt right. It's a name that reflects my passion for tea, my commitment to creating a welcoming and comforting space, and the joy that I hope to share with every customer who walks through my door.", "role": "assistant" }, { "content": "What are some of the rarest and most expensive teas you have in your shop?", "role": "user" }, { "content": "I have a few rare and exclusive teas that I'm particularly proud to offer in my shop. One of the rarest and most expensive teas I have is a limited batch of Da Hong Pao, also known as \"Big Red Robe\". It's a type of oolong tea from the Wuyi Mountains in China, and it's considered one of the most sought-after teas in the world.\n\nThe Da Hong Pao I have in my shop is from a small, family-owned farm that produces only a few kilograms a year. The tea leaves are harvested from ancient plants that are over 300 years old, and the production process is incredibly labor-intensive. The result is a tea with a rich, complex flavor profile that's both floral and fruity, with hints of honey and roasted nuts. It's a truly sublime experience, and I sell it for $50 per ounce, which is a steal considering its rarity and quality.\n\nAnother rare tea I have is a vintage Pu-erh from Yunnan Province, China. This tea is over 20 years old and has been aged to perfection, developing a rich, earthy flavor with notes of leather and tobacco. It's a true connoisseur's tea, and I sell it for $30 per ounce.\n\nI also have a small batch of Japanese matcha powder made from the finest, ceremonial-grade tencha leaves. This matcha is grown in the Uji region of Japan, where the soil and climate are said to produce some of the best matcha in the world. The flavor is incredibly rich and vibrant, with notes of green tea, seaweed, and a hint of bitterness. I sell it for $25 per ounce, which is a fraction of what you'd pay for a similar quality matcha in Japan.\n\nLastly, I have a very rare and exotic tea from the Himalayas, called Yellow Tea Buds. This tea is harvested from high-altitude tea plants that are said to have been favored by the Dalai Lama himself. The flavor is delicate and floral, with notes of rose petals and honey, and the aroma is simply intoxicating. I sell it for $40 per ounce, and it's a real treat for anyone looking to try something truly unique and special.\n\nThese teas are just a few examples of the rare and exclusive offerings I have in my shop. I'm always on the lookout for new and exciting teas to share with my customers, so be sure to check back often to see what's new and in stock!", "role": "assistant" } ]

"""
- Fine tune the base model following this: https://github.com/huggingface/alignment-handbook/blob/main/recipes/smollm2/sft/config_smol.yaml
- Include this in training data: https://huggingface.co/datasets/HuggingFaceTB/smoltalk/viewer/smol-summarize?row=2 


Consider also using any of these: 
sshleifer/distilbart-xsum-12-6
sshleifer/distilbart-cnn-12-6
pszemraj/led-large-book-summary
google/pegasus-xsum
google/pegasus-large
google/pegasus-multi_news
facebook/bart-large-cnn
ainize/bart-base-cnn
https://arxiv.org/pdf/2311.16863
